{
  "$id": "https://max-ai.platform/iam/authz-request.schema.json",
  "title": "Authorization Request",
  "type": "object",
  "required": ["subject", "resource", "action"],
  "properties": {
    "subject": {
      "type": "object",
      "required": ["id", "tenant"],
      "properties": {
        "id": {"type": "string"},
        "tenant": {"type": "string"},
        "roles": {"type": "array", "items": {"type": "string"}},
        "groups": {"type": "array", "items": {"type": "string"}},
        "scopes": {"type": "array", "items": {"type": "string"}}
      },
      "additionalProperties": true
    },
    "resource": {
      "type": "object",
      "required": ["type", "id"],
      "properties": {
        "type": {"type": "string"},
        "id": {"type": "string"},
        "ownerTenant": {"type": "string"}
      },
      "additionalProperties": true
    },
    "action": {"type": "string"},
    "context": {"type": "object", "additionalProperties": true}
  },
  "additionalProperties": false
}
